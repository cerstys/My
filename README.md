Необходимо было в одном запросе выгрузить следующую информацию о группах пользователей:

ARPU 
ARPAU 
CR в покупку 
СR активного пользователя в покупку 
CR пользователя из активности по математике (subject = ’math’) в покупку курса по математике
ARPU считается относительно всех пользователей, попавших в группы.

Активным считается пользователь, за все время решивший больше 10 задач правильно в любых дисциплинах.

Активным по математике считается пользователь, за все время решивший 2 или больше задач правильно по математике.



Вид таблицы peas

| Название атрибута | Тип атрибута | Смысловое значение                      |
|-------------------|--------------|-----------------------------------------|
| st_id             | int          | ID ученика                               |
| timest            | timestamp    | Время решения карточки                   |
| correct           | bool         | Правильно ли решена горошина?            |
| subject           | text         | Дисциплина, в которой находится горошина |



Вид таблицы studs


| Название атрибута | Тип атрибута | Смысловое значение                      |
|-------------------|--------------|-----------------------------------------|
| st_id             | int          | ID ученика                               |
| test_grp          | text         | Метка ученика в данном эксперименте      |



Вид таблицы final_project_check


| Название атрибута | Тип атрибута | Смысловое значение                     |
|-------------------|--------------|----------------------------------------|
| st_id             | int          | ID ученика                              |
| sale_time         | timestamp    | Время покупки                           |
| money             | int          | Цена, по которой приобрели данный курс  |
| subject           | text         | Предмет курса                           |
